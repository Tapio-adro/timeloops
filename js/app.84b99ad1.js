(function(){"use strict";var e={892:function(e,t,i){var a=i(963),s=i(252),l=i(577);const o=(0,s._)("li",{id:"header_title"},[(0,s._)("div",null,"Timeloops")],-1),n=["onClick"],r={key:0},p={id:"edit_todo_toggle"},u={class:"toggle"},d=(0,s._)("div",{class:"toggle-switch"},null,-1),m=(0,s._)("span",{class:"toggle-label"},"Edit mode",-1),c={id:"content_editor"},h={key:0,class:"template"},f={class:"header"},v={class:"parts"},g={class:"part_content"},_=["onUpdate:modelValue"],w=(0,s._)("div",{class:"divider"},null,-1),k=["onUpdate:modelValue"],y=(0,s.Uk)(" Repeat "),T={key:0},I=(0,s.Uk)(" Â "),D=["onUpdate:modelValue"],b=(0,s.Uk)(" times "),P=(0,s._)("div",{class:"divider"},null,-1),O=(0,s.Uk)(" Duration: "),x=(0,s._)("br",null,null,-1),S=["onUpdate:modelValue","onBlur"],U=(0,s.Uk)(" h "),R=["onUpdate:modelValue","onBlur"],C=(0,s.Uk)(" m "),F=["onUpdate:modelValue","onBlur"],V=(0,s.Uk)(" s "),L=(0,s._)("div",{class:"divider"},null,-1),M=["onUpdate:modelValue"],B=(0,s.Uk)(" Pause after finished"),j=(0,s._)("br",null,null,-1),z=(0,s._)("div",{class:"divider"},null,-1),H=(0,s.Uk)(" Change color: "),N=["onUpdate:modelValue"],J=["onClick"],Y=(0,s._)("div",{class:"add_part"},[(0,s._)("i",{class:"fa fa-plus","aria-hidden":"true"})],-1),q=[Y],K={key:1,class:"template_ready"},E={class:"header"},$={class:"header_part"},A={class:"title"},Z={key:0,class:"fa fa-pause","aria-hidden":"true"},G={key:1,class:"fa fa-play","aria-hidden":"true"},Q={class:"timeline"},W={class:"parts"},X={class:"part_wrapper"},ee={class:"part_content"},te={class:"icons"},ie={class:"icon_part part_num"},ae={class:"icon_part"},se={class:"icon_part"},le={key:0,class:"text"},oe={class:"timeline_holder"},ne={class:"timeline"},re=["onClick"],pe={key:0,class:"fa fa-pause","aria-hidden":"true"},ue={key:1,class:"fa fa-play","aria-hidden":"true"},de={class:"countdown_time"},me={class:"part_title"},ce={key:1,id:"content_templates"},he={id:"save_button"},fe={class:"template"},ve={class:"tl_index"},ge={class:"tl_main"},_e={class:"tl_control"},we=["onClick"],ke=["onClick"],ye={class:"tl_display"},Te={class:"part_content"},Ie={class:"icons"},De={key:0,class:"span_margin"},be={class:"time"},Pe={class:"template_title"};function Oe(e,t,i,Y,Oe,xe){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("nav",null,[(0,s._)("ul",null,[o,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Oe.tabs,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t},[(0,s._)("div",{class:(0,l.C_)({active:Oe.curTab==e}),onClick:t=>Oe.curTab=e},(0,l.zw)(e),11,n)])))),128))])]),"editor"==Oe.curTab?((0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",p,[(0,s._)("label",u,[(0,s.wy)((0,s._)("input",{class:"toggle-checkbox",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>Oe.editMode=e)},null,512),[[a.e8,Oe.editMode]]),d,m])]),(0,s._)("div",c,[Oe.editMode?((0,s.wg)(),(0,s.iD)("div",h,[(0,s._)("div",f,[(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{class:"title","onUpdate:modelValue":t[1]||(t[1]=e=>Oe.template.title=e),type:"text",placeholder:"template title"},null,512),[[a.nr,Oe.template.title]])])]),(0,s._)("div",v,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Oe.template.parts,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{class:"part",key:t,style:(0,l.j5)({"background-color":e.color})},[(0,s._)("div",g,[(0,s.Uk)((0,l.zw)(t+1)+". ",1),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t=>e.title=t,type:"text",placeholder:"part title"},null,8,_),[[a.nr,e.title]]),w,(0,s._)("label",null,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":t=>e.repeat=t},null,8,k),[[a.e8,e.repeat]]),y]),e.repeat?((0,s.wg)(),(0,s.iD)("span",T,[I,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t=>e.timesRepeat=t,type:"number"},null,8,D),[[a.nr,e.timesRepeat]]),b])):(0,s.kq)("",!0),P,(0,s._)("div",null,[O,x,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t=>e.duration.hours=t,type:"number",max:"23",onBlur:e=>xe.checkIfTimeFits(t,"hours")},null,40,S),[[a.nr,e.duration.hours]]),U,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t=>e.duration.minutes=t,type:"number",max:"59",onBlur:e=>xe.checkIfTimeFits(t,"minutes")},null,40,R),[[a.nr,e.duration.minutes]]),C,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t=>e.duration.seconds=t,type:"number",max:"59",onBlur:e=>xe.checkIfTimeFits(t,"seconds")},null,40,F),[[a.nr,e.duration.seconds]]),V]),L,(0,s._)("label",null,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":t=>e.pauseOnFinish=t},null,8,M),[[a.e8,e.pauseOnFinish]]),B]),j,z,H,(0,s.wy)((0,s._)("input",{type:"color","onUpdate:modelValue":t=>e.color=t},null,8,N),[[a.nr,e.color]]),(0,s._)("i",{onClick:e=>xe.removePart(t),class:"fa fa-trash fa-lg remove_part","aria-hidden":"true"},null,8,J)])],4)))),128)),(0,s._)("div",{class:"part add_part_container",onClick:t[2]||(t[2]=(...e)=>xe.addPart&&xe.addPart(...e))},q)])])):((0,s.wg)(),(0,s.iD)("div",K,[(0,s._)("div",E,[(0,s._)("div",$,[(0,s._)("div",A,(0,l.zw)(Oe.template.title),1),(0,s._)("div",{class:"play_button",onClick:t[3]||(t[3]=(...e)=>xe.toogleLoop&&xe.toogleLoop(...e))},[Oe.time.loopIsRunning?((0,s.wg)(),(0,s.iD)("i",Z)):((0,s.wg)(),(0,s.iD)("i",G))])]),(0,s._)("div",Q,[(0,s._)("div",{style:(0,l.j5)({width:Oe.time.widthPercentage}),class:"progress_bar"},null,4)])]),(0,s._)("div",W,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Oe.template.parts,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{class:"part",key:t,style:(0,l.j5)({"background-color":e.color})},[(0,s._)("div",X,[(0,s._)("div",ee,[(0,s._)("div",te,[(0,s._)("span",ie,(0,l.zw)(t+1)+". ",1),(0,s._)("span",ae,[(0,s._)("i",{class:(0,l.C_)(["fa fa-step-forward",{active:e.pauseOnFinish}]),"aria-hidden":"true"},null,2)]),(0,s._)("span",se,[(0,s._)("i",{class:(0,l.C_)(["fa fa-refresh",{active:e.repeat,span_margin:e.repeat}]),"aria-hidden":"true"},null,2),e.repeat?((0,s.wg)(),(0,s.iD)("span",le,(0,l.zw)(Oe.time.parts[t].loopsToDo-Oe.time.parts[t].loopsDone),1)):(0,s.kq)("",!0)])]),(0,s._)("div",oe,[(0,s._)("div",ne,[(0,s._)("div",{style:(0,l.j5)({width:Oe.time.parts[t].widthPercentage}),class:"progress_bar"},null,4)]),(0,s._)("div",{class:"play_button",onClick:e=>xe.handlePartClick(t)},[(0,s._)("div",null,[Oe.time.curIndex==t&&Oe.time.loopIsRunning?((0,s.wg)(),(0,s.iD)("i",pe)):((0,s.wg)(),(0,s.iD)("i",ue))])],8,re)]),(0,s._)("div",de,[(0,s._)("div",null,(0,l.zw)(Oe.time.parts[t].timeLeft),1)])])]),(0,s._)("div",me,(0,l.zw)(e.title),1)],4)))),128))])]))])])):(0,s.kq)("",!0),"templates"==Oe.curTab?((0,s.wg)(),(0,s.iD)("div",ce,[(0,s._)("div",he,[(0,s._)("div",{onClick:t[4]||(t[4]=e=>Oe.templates.unshift(JSON.parse(JSON.stringify(Oe.template))))}," Save current template ")]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(Oe.templates,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t},[(0,s._)("div",fe,[(0,s._)("div",ve,(0,l.zw)(t+1),1),(0,s._)("div",ge,[(0,s._)("div",_e,[(0,s._)("div",{class:"tl_load",onClick:t=>{Oe.template=JSON.parse(JSON.stringify(e)),Oe.curTab="editor"}},"Load",8,we),(0,s._)("i",{onClick:e=>xe.removeTemplate(t),class:"fa fa-trash fa-lg","aria-hidden":"true"},null,8,ke)]),(0,s._)("div",ye,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.parts,((e,t)=>((0,s.wg)(),(0,s.iD)("div",{key:t,class:"tl_part",style:(0,l.j5)({"background-color":e.color})},[(0,s._)("div",Te,[(0,s._)("div",Ie,[(0,s._)("i",{class:(0,l.C_)(["fa fa-step-forward",{active:e.pauseOnFinish}]),"aria-hidden":"true"},null,2),(0,s._)("i",{class:(0,l.C_)(["fa fa-refresh",{active:e.repeat}]),"aria-hidden":"true"},null,2),e.repeat?((0,s.wg)(),(0,s.iD)("span",De,(0,l.zw)(e.timesRepeat),1)):(0,s.kq)("",!0)]),(0,s._)("div",be,(0,l.zw)(xe.getTimeStringFromPart(e)),1)])],4)))),128))])])]),(0,s._)("div",Pe,[(0,s._)("div",null,(0,l.zw)(e.title),1)])])))),128))])):(0,s.kq)("",!0)],64)}var xe={name:"App",data(){return{editMode:!1,curTab:"editor",template:{title:"Example loop",looped:!0,parts:[{title:"simple part",pauseOnFinish:!1,duration:{hours:0,minutes:0,seconds:5},repeat:!1,color:Fe(),timesRepeat:3},{title:"repeats",pauseOnFinish:!1,duration:{hours:0,minutes:0,seconds:3},repeat:!0,color:Fe(),timesRepeat:3},{title:"pauses on finish",pauseOnFinish:!0,duration:{hours:0,minutes:0,seconds:5},repeat:!1,color:Fe(),timesRepeat:3},{title:"last part",pauseOnFinish:!1,duration:{hours:0,minutes:1,seconds:0},repeat:!1,color:Fe(),timesRepeat:3}]},time:{},tabs:["templates","editor"],templates:[]}},watch:{editMode(){this.editMode?(clearInterval(this.time.interval),clearInterval(this.time.templateIterval)):this.compileTemplate()},curTab(){"editor"==this.curTab||this.editMode?"editor"!=this.curTab||this.editMode||this.compileTemplate():(clearInterval(this.time.interval),clearInterval(this.time.templateIterval))}},methods:{addPart(){let e={title:"",pauseOnFinish:!1,duration:{hours:0,minutes:0,seconds:10},repeat:!1,color:Fe(),timesRepeat:3};this.template.parts.push(e)},removePart(e){this.template.parts.splice(e,1)},removeTemplate(e){this.templates.splice(e,1)},checkIfTimeFits(e,t){let i={seconds:59,minutes:59,hours:23}[t],a=this.template.parts[e].duration[t];this.template.parts[e].duration[t]=a>i?i:a},compileTemplate(){this.time={},this.time.parts=[],this.time.curIndex=0,this.time.loopIsRunning=!1,this.time.startedLoop=!1,this.time.spentTimeBeforePause=0,this.time.widthPercentage=0;for(let e in this.template.parts){let t=this.template.parts[e];this.time.parts[e]={widthPercentage:0,loopsToDo:t.repeat?t.timesRepeat:1,loopsDone:0,isLastPart:this.template.parts.length==Number(e)+1,timeLeft:Re(t)}}},toogleLoop(){if(this.time.startedLoop){if(this.time.shouldStop)return this.time.shouldStop=!1,this.time.spentTimeBeforePause=0,this.time.loopIsRunning=!1,void clearInterval(this.time.interval);this.time.loopIsRunning?(this.time.spentTimeBeforePause=0,this.time.loopIsRunning=!1,clearInterval(this.time.interval),this.time.spentTimeBeforePause=this.time.spentTime):(this.time.loopIsRunning=!0,this.nextInterval())}else this.time.startedLoop=!0,this.time.loopIsRunning=!0,this.time.curIndex=0,this.nextInterval(),this.updateTemplateProgress()},assignDatesForPart(e){this.time.paused=!1;let t=new Date,i=this.template.parts[e].duration;this.time.endDate=new Date(t.setHours(t.getHours()+i.hours,t.getMinutes()+i.minutes,t.getSeconds()+i.seconds)),this.time.startDate=new Date,this.time.fullDistance=this.time.endDate.getTime()-this.time.startDate.getTime()},nextInterval(){this.assignDatesForPart(this.time.curIndex),this.time.interval=setInterval((()=>{let e=this.time.curIndex,t=new Date;this.time.spentTime=t.getTime()-this.time.startDate.getTime()+this.time.spentTimeBeforePause;let i=Math.floor(this.time.spentTime/this.time.fullDistance*100);if(i>=100){clearInterval(this.time.interval),this.time.spentTimeBeforePause=0;let t=this.time.parts[e];t.widthPercentage="100%",t.loopsDone+=1,t.loopsDone==t.loopsToDo?(t.loopsDone,t.isLastPart?(clearInterval(this.time.templateIterval),this.compileTemplate(),this.template.parts[e].pauseOnFinish||this.toogleLoop()):(this.time.spentTime=0,this.time.curIndex+=1,t.timeLeft="-",this.template.parts[e].pauseOnFinish?this.time.loopIsRunning=!1:this.nextInterval())):(this.time.spentTime=0,this.nextInterval())}else this.time.parts[e].widthPercentage=i+"%",this.time.parts[e].timeLeft=Ce(this.time.fullDistance-this.time.spentTime)}),200)},handlePartClick(e){let t=this.time.curIndex;if(t==e)this.toogleLoop();else if(t-1==e&&this.template.parts[e].pauseOnFinish&&0==this.time.loopIsRunning)console.log("do"),this.toogleLoop();else{this.time.startedLoop||(this.toogleLoop(),this.handlePartClick(e));for(let t in this.time.parts){let i=this.time.parts[t];t<e?(i.loopsDone=i.loopsToDo,i.widthPercentage="100%",i.timeLeft="-"):(i.loopsDone=0,i.widthPercentage="0%",i.timeLeft=Re(this.template.parts[t]))}this.time.shouldStop=!0,this.toogleLoop(),this.time.curIndex=e,this.toogleLoop()}},updateTemplateProgress(){let e=Se(this.template);this.time.updateIntervalTime=e/100,this.time.templateIterval=setInterval((()=>{if(this.time.loopIsRunning){let t=Ue(this.template,this.time);this.time.widthPercentage=t/e*100+"%"}}),200)},saveTemplates(){localStorage.setItem("lastTemplate",JSON.stringify(this.template)),localStorage.setItem("templates",JSON.stringify(this.templates))},getTimeStringFromPart(e){return Re(e)}},beforeMount(){localStorage.getItem("firstTimeHere")?localStorage.getItem("templates")&&(this.templates=JSON.parse(localStorage.getItem("templates"))):(localStorage.setItem("firstTimeHere","true"),this.templates=Ve()),localStorage.getItem("lastTemplate")&&(this.template=JSON.parse(localStorage.getItem("lastTemplate"))),this.compileTemplate()},mounted(){window.onbeforeunload=this.saveTemplates}};function Se(e){let t=e.parts,i=0;for(let s of t){let e=a(s),t=1;s.repeat&&(t=s.timesRepeat);for(let a=0;a<t;a++)i+=e}return i;function a(e){let t=3600*e.duration.hours+60*e.duration.minutes+e.duration.seconds;return t}}function Ue(e,t){t.parts;let i=0;for(let s in t.parts){let l=t.parts[s],o=e.parts[s];if("100%"==l.widthPercentage&&(!o.repeat||l.loopsDone==l.loopsToDo)){let e=a(o),t=1;o.repeat&&(t=o.timesRepeat);for(let a=0;a<t;a++)i+=e}}if(e.parts[t.curIndex].repeat){let s=t.parts[t.curIndex],l=a(e.parts[t.curIndex]);for(let e=0;e<s.loopsDone;e++)i+=l}return i+=t.spentTime/1e3,i;function a(e){let t=3600*e.duration.hours+60*e.duration.minutes+e.duration.seconds;return t}}function Re(e){let t="",i=e.duration,a=[{key:"hours",short:"h"},{key:"minutes",short:"m"},{key:"seconds",short:"s"}];for(let s in a){let e=a[s];0!=i[e.key]&&(t+=String(i[e.key])+e.short,t+=" ")}return t=t.trim(),""==t?"-":t}function Ce(e){let t="",i=Math.floor(e/1e3)+1,a=[{short:"h",timeValue:Math.floor(i/60/60)},{short:"m",timeValue:Math.floor(i/60%60)},{short:"s",timeValue:Math.floor(i%60)}];for(let s in a){let e=a[s];0!=e.timeValue&&(t+=String(e.timeValue)+e.short,t+=" ")}return t=t.trim(),""==t?"-":t}function Fe(){let e=Math.floor(360*Math.random()),t=70,i=70;i/=100;const a=t*Math.min(i,1-i)/100,s=t=>{const s=(t+e/30)%12,l=i-a*Math.max(Math.min(s-3,9-s,1),-1);return Math.round(255*l).toString(16).padStart(2,"0")};return`#${s(0)}${s(8)}${s(4)}`}function Ve(){return[{title:"Pomodoro",looped:!0,parts:[{title:"work",pauseOnFinish:!1,duration:{hours:0,minutes:40,seconds:0},repeat:!1,color:Fe(),timesRepeat:3},{title:"rest",pauseOnFinish:!1,duration:{hours:0,minutes:20,seconds:0},repeat:!1,color:Fe(),timesRepeat:3}]},{title:"Simple countdown",looped:!0,parts:[{title:"",pauseOnFinish:!1,duration:{hours:0,minutes:1,seconds:0},repeat:!1,color:Fe(),timesRepeat:3}]}]}var Le=i(744);const Me=(0,Le.Z)(xe,[["render",Oe]]);var Be=Me;(0,a.ri)(Be).mount("#app")}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var l=t[a]={exports:{}};return e[a](l,l.exports,i),l.exports}i.m=e,function(){var e=[];i.O=function(t,a,s,l){if(!a){var o=1/0;for(u=0;u<e.length;u++){a=e[u][0],s=e[u][1],l=e[u][2];for(var n=!0,r=0;r<a.length;r++)(!1&l||o>=l)&&Object.keys(i.O).every((function(e){return i.O[e](a[r])}))?a.splice(r--,1):(n=!1,l<o&&(o=l));if(n){e.splice(u--,1);var p=s();void 0!==p&&(t=p)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[a,s,l]}}(),function(){i.d=function(e,t){for(var a in t)i.o(t,a)&&!i.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};i.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,l,o=a[0],n=a[1],r=a[2],p=0;if(o.some((function(t){return 0!==e[t]}))){for(s in n)i.o(n,s)&&(i.m[s]=n[s]);if(r)var u=r(i)}for(t&&t(a);p<o.length;p++)l=o[p],i.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return i.O(u)},a=self["webpackChunktimeloops"]=self["webpackChunktimeloops"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=i.O(void 0,[998],(function(){return i(892)}));a=i.O(a)})();
//# sourceMappingURL=app.84b99ad1.js.map